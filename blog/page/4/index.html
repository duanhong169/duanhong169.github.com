
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>弘's blog</title>
  <meta name="author" content="弘哥保护你">

  
  <meta name="description" content="很多时候，感觉自己想要说点什么，但是却一个字也吐不出来。看着对方一行一行的字出现，更是觉得越来越大的压力，以至于更加不知道说什么好了。 不能怨别人，肤浅的人总是缺少语言，对一件事缺少感情，自然也不会对它产生多少的理解，更不用说对其侃侃而谈了。 想起以前语文考试都要写的八百字作文， &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://duanhong169.github.com/blog/page/4/index.html">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="弘's blog" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-32127208-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">弘's blog</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:duanhong169.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/no-words.html">为什么总是缺少语言</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-30T14:48:53+08:00" pubdate data-updated="true">Oct 30<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>很多时候，感觉自己想要说点什么，但是却一个字也吐不出来。看着对方一行一行的字出现，更是觉得越来越大的压力，以至于更加不知道说什么好了。</p>

<p>不能怨别人，肤浅的人总是缺少语言，对一件事缺少感情，自然也不会对它产生多少的理解，更不用说对其侃侃而谈了。</p>

<p>想起以前语文考试都要写的八百字作文，现在觉得真是能凑齐字数都是困难，过了这么多年，却是越来越退化了，一直以来都不怎么喜欢阅读，觉得都是别人写的一些与自己无关的话罢了，因此自从上了大学之后，没有了向高中那样的硬性要求，反而是阅读得更少了，要写什么东西，首先想到的是到网络上搜集一些别人的材料，然后照着别人的模式来写，根本就少有加入自身的思考，久而久之这些能力也就弱化了吧。本来就不强的东西，现在倒是更加弱化了，真不知道是该叹气还是该哭。</p>

<p>看文章总不愿看超过2页的习惯，导致这些年来最喜欢看的就是些短文，笑话幽默什么的，这样的话什么《读者》啊《青年文摘》呀应该比较适合我吧？错了，就连这上面的文章70%我都觉得太长了，更不用说看什么小说了。我想正是因为这个原因，导致了我总是感觉缺少语言吧，现在得去在这方面加强一点努力了，不然总是会误了很多事的。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/i-can-not-wake-up.html">I Can Not Wake Up</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-27T16:02:47+08:00" pubdate data-updated="true">Oct 27<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>是意志不够坚定吗？但是我确实感觉太累了，感觉即使我能逃离这张床，也必定会在某个地方趴着睡着。</p>

<p>唉 谁能教会我深度睡眠就好了~我觉得以前的我就是这样的，感觉每天睡四到六个小时就足够了，第二天一样精神满满，现在怎么就不行了呢。是环境变了吗，还是我自己变了。</p>

<p>不过我知道我是个很难改变的人，缺点一大堆，但总是改不了，总是让人生气让人不爽，但是自己却总是不能改变，改变也仅仅是在口头上说说，在形式上改变，而实际上却还是在骨头里保留着原来的想法。</p>

<blockquote><p>只想做自己喜欢的事，这样的决定当然无可厚非。但是在现实中，为了做自己喜欢的事情，必须做很多不那么喜欢的事情，如果对于这一点能欣然接收的话就好了。</p></blockquote>

<p>确实，如果你想要得到一个东西或者去做一件事，那么你不能够期望毫无代价的去达到你的目的，世界不是为你一个人而准备的，你必须要学会付出，你才能得到你想要的东西，完成你想要做成的事情。</p>

<blockquote><p>如果真的喜欢的话，就不会觉得辛苦了。如果害怕辛苦而不愿付出努力，那只能说，不是真正的喜欢这件事。</p></blockquote>

<p>对于一件事我是否真的打心底里觉得喜欢呢？或许这才是关键的问题，可能自己对于喜欢的概念都弄错了，因为没有发现自己真正喜欢的，所以觉得自己喜欢的就是现在的这个样子。</p>

<p>人生应该怎样度过？工作、积累财产、提升教养、满足爱好、建立家庭和保持身体健康，我要在对待这几点的观点上做出一些改变，认真对待他们。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/sleep-late.html">晚睡强迫症</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-26T01:48:22+08:00" pubdate data-updated="true">Oct 26<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>为什么夜深了却越是睡不着呢··七八点的时候倒是会有点打瞌睡。
那时候又不敢睡~怕晚上突然醒了就悲剧了，最痛苦的事情还是是失眠呀。</p>

<p>最近感觉自己越来越SB了，经常不知道自己在做什么，发现别人都很聪明~懂得多吐槽又厉害还能够精辟的分析历史和时事。</p>

<p>寝室总有几只蚊子在嗡嗡的飞，偶尔拍死两个却总也灭绝不了，躺在床上过几分钟黑暗中就有蚊子飞过来，真是要气死爹啊。
电脑的破硬盘的声音感觉大得出奇，这渣质量估计过两天就又得坏了~就是因为它都搞得我有点神经过敏了，总是感觉有什么东西在响，
声音不是很大但是就是能听见，还是持续不断的那种，特别烦，今天中午睡午觉的时候把电脑待机，我居然能听见和待机灯闪烁频率一样的电源里的电流声，真是要了个命了哦，中途不得不下去把电脑关掉，瞬间感觉清净了，睡了几分钟好觉。
不过今天又被导师叫去找学校盖一个合同的章，这样的事真是让我无力啊~感觉除了浪费时间之外就是浪费A4纸了，没办法还是得去跑，但是学校的那些老师行踪总是不确定，总是不能保证在确定的地方能找到他，平时不觉得，一要找了就找不到了，明天还得去。</p>

<p>不过最近发现豆瓣FM是个不错的东西，界面简洁，功能独特，总是能跳出一些很好听的歌，就是白天经常会很卡，听都听不起，网上说可能是电信dns的原因，也不知道怎么整~各种浏览器都试了，桌面版的也下下来试了，统统都不行唉~真是没有一件事让我舒心的。</p>

<p>还是睡觉吧，睡个好觉。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/android-google-weather-api.html">Android Google Weather API调用示例</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-22T00:27:47+08:00" pubdate data-updated="true">Oct 22<span>nd</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>该示例简单地对Google Weather API进行了调用并解析了返回的xml数据，然后展示到Activity。
Demo截图：
[fgallery id=2 w=480 h=480 t=0 title=&#8221;weatherapp&#8221;]
Android Project结构：
<a href="http://l4love.org/wp-content/uploads/2011/10/project-hierarchy.png"><img src="http://l4love.org/wp-content/uploads/2011/10/project-hierarchy.png" alt="" /></a>
天气信息抽象数据类型WeatherInfo.java：
[java]package com.honson.weatherapp;</p>

<p>public class WeatherInfo {</p>

<pre><code>String city_name;
String update_time;

String condition;
String temp_f;
String temp_c;
String humidity;
String icon;
String wind_condition;

String day_of_week;
String temp_low_f;
String temp_high_f;

public String getUpdate_time() {
    return update_time;
}

public void setUpdate_time(String update_time) {
    this.update_time = update_time;
}

public String getDay_of_week() {
    return day_of_week;
}

public void setDay_of_week(String day_of_week) {
    this.day_of_week = day_of_week;
}

public String getTemp_low_f() {
    return temp_low_f;
}

public void setTemp_low_f(String temp_low_f) {
    this.temp_low_f = temp_low_f;
}

public String getTemp_high_f() {
    return temp_high_f;
}

public void setTemp_high_f(String temp_high_f) {
    this.temp_high_f = temp_high_f;
}

public void setCity_name(String attribute) {
    city_name = attribute;
}

public void setCondition(String attribute) {
    condition = attribute;
}

public void setTemp_f(String attribute) {
    temp_f = attribute;
}

public void setTemp_c(String attribute) {
    temp_c = attribute;
}

public void setHumidity(String attribute) {
    humidity = attribute;       
}

public void setIconPath(String attribute) {
    icon = attribute;       
}

public void setWind_condition(String attribute) {
    wind_condition = attribute;     
}

public String getCity_name() {
    return city_name;
}

public String getCondition() {
    return condition;
}

public String getTemp_f() {
    return temp_f;
}

public String getHumidity() {
    return humidity;
}

public String getTemp_c() {
    return temp_c;
}

public String getWind_condition() {
    return wind_condition;
}

public String getIconPath() {
    return icon;
}
</code></pre>

<p>}
[/java]
xml文档解析类DomXMLReader.java：
[java]package com.honson.weatherapp;</p>

<p>import java.io.InputStream;
import java.util.ArrayList;
import java.util.List;</p>

<p>import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;</p>

<p>import org.w3c.dom.Document;
import org.w3c.dom.Element;
import org.w3c.dom.Node;
import org.w3c.dom.NodeList;</p>

<p>public class DomXMLReader {</p>

<pre><code>public static List&lt;WeatherInfo&gt; readXML(InputStream inStream) {
    List&lt;WeatherInfo&gt; weatherReportList = new ArrayList&lt;WeatherInfo&gt;();
    DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
    try {
        DocumentBuilder builder = factory.newDocumentBuilder();
        Document dom = builder.parse(inStream);
        Element root = dom.getDocumentElement();
        NodeList items = root.getElementsByTagName("current_conditions");//查找所有CurrentCondition节点
        for (int i = 0; i &lt; items.getLength(); i++) {
            WeatherInfo currentCondition = new WeatherInfo();
            //得到第一个CurrentCondition节点
            Element currentNode = (Element) items.item(i);
            //获取所有子节点
            NodeList childsNodes = currentNode.getChildNodes();
            for (int j = 0; j &lt; childsNodes.getLength(); j++) {
                Node node = (Node) childsNodes.item(j);
                //判断是否为元素类型
                if(node.getNodeType() == Node.ELEMENT_NODE){
                    Element childNode = (Element) node;
                    //判断是否condition元素
                    if ("condition".equals(childNode.getNodeName())) {
                        //获取condition节点的data属性值
                        currentCondition.setCondition(childNode.getAttribute("data"));
                    } else if ("temp_f".equals(childNode.getNodeName())) {
                        //获取temp_f节点的data属性值
                        currentCondition.setTemp_f(childNode.getAttribute("data"));
                    } else if ("temp_c".equals(childNode.getNodeName())) {
                        //获取temp_c节点的data属性值
                        currentCondition.setTemp_c(childNode.getAttribute("data"));
                    } else if ("humidity".equals(childNode.getNodeName())) {
                        //获取humidity节点的data属性值
                        currentCondition.setHumidity(childNode.getAttribute("data"));
                    } else if ("icon".equals(childNode.getNodeName())) {
                        //获取iconPath节点的data属性值
                        currentCondition.setIconPath(childNode.getAttribute("data"));
                    } else if ("wind_condition".equals(childNode.getNodeName())) {
                        //获取wind_condition节点的data属性值
                        currentCondition.setWind_condition(childNode.getAttribute("data"));
                    }
                }
            }
            weatherReportList.add(currentCondition);
        }
        items = root.getElementsByTagName("forecast_information");//查找所有forecast_information节点
        for (int i = 0; i &lt; items.getLength(); i++) {
            WeatherInfo forecastInformation = new WeatherInfo();
            //得到一个forecastInformation节点
            Element currentNode = (Element) items.item(i);
            //获取所有子节点
            NodeList childsNodes = currentNode.getChildNodes();
            for (int j = 0; j &lt; childsNodes.getLength(); j++) {
                Node node = (Node) childsNodes.item(j);
                //判断是否为元素类型
                if(node.getNodeType() == Node.ELEMENT_NODE){
                    Element childNode = (Element) node;
                    //判断是否city元素
                    if ("city".equals(childNode.getNodeName())) {
                        //获取city节点的data属性值
                        forecastInformation.setCity_name(childNode.getAttribute("data"));
                    } else if ("current_date_time".equals(childNode.getNodeName())) {
                        //获取current_date_time节点的data属性值
                        forecastInformation.setUpdate_time(childNode.getAttribute("data"));
                    } 
                }
            }
            weatherReportList.add(forecastInformation);
        }
        items = root.getElementsByTagName("forecast_conditions");//查找所有forecast_conditions节点
        for (int i = 0; i &lt; items.getLength(); i++) {
            WeatherInfo forecastCondition = new WeatherInfo();
            //得到第一个forecastCondition节点
            Element currentNode = (Element) items.item(i);
            //获取所有子节点
            NodeList childsNodes = currentNode.getChildNodes();
            for (int j = 0; j &lt; childsNodes.getLength(); j++) {
                Node node = (Node) childsNodes.item(j);
                //判断是否为元素类型
                if(node.getNodeType() == Node.ELEMENT_NODE){
                    Element childNode = (Element) node;
                    //判断是否condition元素
                    if ("condition".equals(childNode.getNodeName())) {
                        //获取condition节点的data属性值
                        forecastCondition.setCondition(childNode.getAttribute("data"));
                    } else if ("day_of_week".equals(childNode.getNodeName())) {
                        //获取day_of_week节点的data属性值
                        forecastCondition.setDay_of_week(childNode.getAttribute("data"));
                    } else if ("low".equals(childNode.getNodeName())) {
                        //获取low节点的data属性值
                        forecastCondition.setTemp_low_f(childNode.getAttribute("data"));
                    } else if ("high".equals(childNode.getNodeName())) {
                        //获取high节点的data属性值
                        forecastCondition.setTemp_high_f(childNode.getAttribute("data"));
                    } else if ("icon".equals(childNode.getNodeName())) {
                        //获取iconPath节点的data属性值
                        forecastCondition.setIconPath(childNode.getAttribute("data"));
                    } 
                }
            }
            weatherReportList.add(forecastCondition);
        }
        inStream.close();
    } catch (Exception e) {
        e.printStackTrace();
    }
    return weatherReportList;
}
</code></pre>

<p>}
[/java]
Activity代码WeatherAppActivity.java：
[java]package com.honson.weatherapp;</p>

<p>import java.io.ByteArrayInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.net.HttpURLConnection;
import java.net.MalformedURLException;
import java.net.URL;
import java.util.ArrayList;
import java.util.List;
import java.util.Timer;
import java.util.TimerTask;</p>

<p>import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.HttpStatus;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.protocol.BasicHttpContext;
import org.apache.http.protocol.HttpContext;
import org.apache.http.util.EntityUtils;</p>

<p>import android.app.Activity;
import android.content.pm.ActivityInfo;
import android.content.res.Configuration;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.os.AsyncTask;
import android.os.Bundle;
import android.os.Handler;
import android.text.InputType;
import android.util.Log;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.inputmethod.InputMethodManager;
import android.widget.Button;
import android.widget.EditText;
import android.widget.ImageView;
import android.widget.TextView;
import android.widget.Toast;</p>

<p>public class WeatherAppActivity extends Activity implements OnClickListener {</p>

<pre><code>private static final String GOOGLE_API_URL = "http://www.google.com/ig/api?weather=";        
private static final String NETWORK_ERROR = "Zip code not found.\nPlease check the zip code.\nE.g.:10010 --&gt; New York\n94043 --&gt; Mountain View";
private static final String TAG = "WeatherReport";        
private EditText editText;
private Button button;
private TextView tvWeatherInfo, tvWeatherInfo01, tvWeatherInfo02, tvWeatherInfo03, tvWeatherInfo04; // Display weather information
private TextView time, time01, time02, time03, time04;
private ImageView icon, icon01, icon02, icon03, icon04;
private List&lt;String&gt; times = new ArrayList&lt;String&gt;();
private List&lt;Bitmap&gt; bms = new ArrayList&lt;Bitmap&gt;();
private Handler mHandler;
@Override
public void onCreate(Bundle savedInstanceState) {
    Log.v(TAG, "onCreate()");
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    mHandler = new Handler();
    findView();
    button.setOnClickListener(this);
    Timer timer = new Timer();
    timer.schedule(new TimerTask() {
        @Override
        public void run() {
            hideInputMethodView();//隐藏掉可能的已存在的软键盘
            requestInputMethodView();
        }
    }, 1000);  //在一秒后打开(等待View绘制完成才能打开软键盘)
}

private void findView(){
    editText = (EditText) findViewById(R.id.editText);
    button = (Button) findViewById(R.id.goQuery);
    icon = (ImageView) findViewById(R.id.icon);
    time = (TextView) findViewById(R.id.time);
    tvWeatherInfo = (TextView) findViewById(R.id.tvWeatherInfo);
    icon01 = (ImageView) findViewById(R.id.icon01);
    time01 = (TextView) findViewById(R.id.time01);
    tvWeatherInfo01 = (TextView) findViewById(R.id.tvWeatherInfo01);
    icon02 = (ImageView) findViewById(R.id.icon02);
    time02 = (TextView) findViewById(R.id.time02);
    tvWeatherInfo02 = (TextView) findViewById(R.id.tvWeatherInfo02);
    icon03 = (ImageView) findViewById(R.id.icon03);
    time03 = (TextView) findViewById(R.id.time03);
    tvWeatherInfo03 = (TextView) findViewById(R.id.tvWeatherInfo03);
    icon04 = (ImageView) findViewById(R.id.icon04);
    time04 = (TextView) findViewById(R.id.time04);
    tvWeatherInfo04 = (TextView) findViewById(R.id.tvWeatherInfo04);
}

private void resetView(){
    icon.setImageDrawable(null);
    time.setText(null);
    tvWeatherInfo.setText(null);
    icon01.setImageDrawable(null);
    time01.setText(null);
    tvWeatherInfo01.setText(null);
    icon02.setImageDrawable(null);
    time02.setText(null);
    tvWeatherInfo02.setText(null);
    icon03.setImageDrawable(null);
    time03.setText(null);
    tvWeatherInfo03.setText(null);
    icon04.setImageDrawable(null);
    time04.setText(null);
    tvWeatherInfo04.setText(null);
}

@Override
protected void onResume() {
    Log.v(TAG, "onResume()");
    super.onResume();
}

public void onClick(View v) {
    //获得用户输入的城市名称
    String city = editText.getText().toString();
    // 必须每次都重新创建一个新的task实例进行查询，否则将提示如下异常信息
    // the task has already been executed (a task can be executed only once)
    city = city.replace(" ", "%20");
    Log.v(TAG, city);
    new GetWeatherTask().execute(city);
    resetView();
    //把天气信息显示出来
    tvWeatherInfo.setText("Pending...");
    hideInputMethodView();
    //setTitle(weather);
}

@Override
public void onConfigurationChanged(Configuration newConfig) {
    Log.v(TAG, "onConfigurationChange()");
    Log.v(TAG, newConfig.orientation + "");
    hideInputMethodView();
    // 当屏幕布局模式变为portrait时
    if(newConfig.orientation == ActivityInfo.SCREEN_ORIENTATION_PORTRAIT)
    {
        editText.setText(null);
        editText.setHint(R.string.hint_string_portrait);
        editText.setInputType(InputType.TYPE_CLASS_PHONE);
        //icon.setImageDrawable(null);
        //tvWeatherInfo.setText(R.string.indicate_string_portrait);
        requestInputMethodView();
    }
    // 当屏幕布局模式变为landscape时
    if(newConfig.orientation == ActivityInfo.SCREEN_ORIENTATION_USER)
    {
        editText.setText(null);
        editText.setHint(R.string.hint_string_landscape);
        editText.setInputType(InputType.TYPE_CLASS_TEXT);
        //icon.setImageDrawable(null);
        //tvWeatherInfo.setText(R.string.indicate_string_landscape);
        requestInputMethodView();
    }
    super.onConfigurationChanged(newConfig);
}

/**
 * 该方法用于在需要的时候弹出软键盘
 */
private void requestInputMethodView() {
    Log.v(TAG, "requestInputMethodView()");
    mHandler.post(new Runnable() {

        public void run() {
            Log.v(TAG, "InputMethodManager imm");
            InputMethodManager imm = (InputMethodManager) WeatherAppActivity.this.getBaseContext().getSystemService(INPUT_METHOD_SERVICE);
            imm.showSoftInput(editText, InputMethodManager.SHOW_FORCED);
            if(WeatherAppActivity.this.getResources().getConfiguration().orientation == ActivityInfo.SCREEN_ORIENTATION_PORTRAIT){
                Toast.makeText(WeatherAppActivity.this, R.string.indicate_string_portrait, Toast.LENGTH_SHORT).show();
            }else{
                Toast.makeText(WeatherAppActivity.this, R.string.indicate_string_landscape, Toast.LENGTH_SHORT).show();
            }

        }
    });
}

private void hideInputMethodView() {
    InputMethodManager imm = (InputMethodManager) this.getBaseContext().getSystemService(INPUT_METHOD_SERVICE);
    imm.hideSoftInputFromWindow(editText.getWindowToken(), 0);
}

/**
 * 从Google Weather API获取数据
 * @param city 城市名称或邮政编码
 * @return 天气数据信息
 */
public List&lt;String&gt; getWeatherByCity(String city) {
    HttpClient httpClient = new DefaultHttpClient();
    HttpContext localContext = new BasicHttpContext();
    HttpGet httpGet = new HttpGet(GOOGLE_API_URL + city);
    Log.v(TAG, GOOGLE_API_URL + city);
    try {HttpResponse response = httpClient.execute(httpGet, localContext);
        if (response.getStatusLine().getStatusCode() != HttpStatus.SC_OK) {
            Log.e(TAG, "Failed. status code is not ok.");
            httpGet.abort();
        } 
        else { 
            // Get weather information successful
            // Reset charset
            HttpEntity httpEntity = response.getEntity();
            String string = EntityUtils.toString(httpEntity, "utf-8").trim();
            InputStream is = new ByteArrayInputStream(string.getBytes("utf-8"));
            return parseWeather(is);
        }
    } catch (Exception e) {
        Log.e(TAG, "Failed to get weather", e);
    } finally {
        httpClient.getConnectionManager().shutdown();
    }
    List&lt;String&gt; error = new ArrayList&lt;String&gt;();
    error.add(NETWORK_ERROR);
    return error;
}

/**
 * 解析xml得出天气数据
 * @param is 由Google Weather API返回的输入流
 * @return 天气数据
 * @throws IOException
 */
public List&lt;String&gt; parseWeather(InputStream is) throws IOException { 
    List&lt;WeatherInfo&gt; list = DomXMLReader.readXML(is);
    List&lt;String&gt; weatherInfos = new ArrayList&lt;String&gt;();
    WeatherInfo weather_report = list.get(0);
    if(weather_report.getIconPath().endsWith(".gif"));{
        try
        {
            bms.add(getNetBitmap("http://www.google.com" + weather_report.getIconPath()));

        }
        catch (Exception e)
        {
            Log.e(TAG, "IOException");
        }
    }
    times.add("Now");
    String without_city_name_and_time = "Condition: " + new String(weather_report.getCondition().getBytes(), "utf-8") + ", "
         + "Temp_f: " + weather_report.getTemp_f() + "℉\n"
         //+ "Temp_c: " + weather_report.getTemp_c() + "℃\n"
         + weather_report.getHumidity() + ", "
</code></pre>

<p>//             + current.getIconPath() + &#8220;\n&#8221;</p>

<pre><code>         + weather_report.getWind_condition();
    weather_report = list.get(1);
    String city_name_and_time = "City: " + new String(weather_report.getCity_name().getBytes(), "utf-8") + "\n"
         //+ "Update Time: " + weather_report.getUpdate_time() + "\n"
         ;
    weatherInfos.add(city_name_and_time + without_city_name_and_time);
    for(int i = 2; i &lt;= 5; i++){
         weather_report = list.get(i);
         times.add(weather_report.getDay_of_week());
         if(weather_report.getIconPath().endsWith(".gif"));{
            try
            {
                bms.add(getNetBitmap("http://www.google.com" + weather_report.getIconPath()));

            }
            catch (Exception e)
            {
                Log.e(TAG, "IOException");
            }
         }
         String forecastCondition = "Condition: " + new String(weather_report.getCondition().getBytes(), "utf-8") + "\n"
                 + "Temp_low_f: " + weather_report.getTemp_low_f() + "℉\n"
                 + "Temp_high_f: " + weather_report.getTemp_high_f() + "F\n";
         weatherInfos.add(forecastCondition);
    }
    return weatherInfos;
}

/**
 * 获取天气图片
 * @param url 图片url
 * @return
 */
private Bitmap getNetBitmap(String url){
    URL imageUrl = null;
    Bitmap bitmap = null;
    try {
        imageUrl = new URL(url);
    }
    catch (MalformedURLException e){
        Log.e(TAG, e.getMessage());
    }
    try {
        HttpURLConnection conn = (HttpURLConnection)imageUrl.openConnection();
        conn.setDoInput(true);
        conn.connect();
        InputStream is = conn.getInputStream();
        bitmap = BitmapFactory.decodeStream(is);
        is.close();
    } catch (IOException e){
        Log.e(TAG, "IOException");
    }
    return bitmap;
}

/**
 * 采用异步任务更新显示
 * @author honson
 *
 */
class GetWeatherTask extends AsyncTask&lt;String, Integer, List&lt;String&gt;&gt; {

    @Override
    protected List&lt;String&gt; doInBackground(String... params) {
        String city = params[0];

        // 调用Google天气API查询指定城市的当日天气情况
        return getWeatherByCity(city);
    }

    protected void onPostExecute(List&lt;String&gt; result) {
        if(result.size() == 1){
            if(WeatherAppActivity.this.getResources().getConfiguration().orientation == ActivityInfo.SCREEN_ORIENTATION_PORTRAIT){
                resetView();
                tvWeatherInfo.setText(result.get(0));
            }
            return;
        }
        if(result.size() != 5 || times.size() != 5 || bms.size() !=5 || times == null) {
            //tvWeatherInfo.setText(result.get(0));
            return;
        }
        // 把doInBackground处理的结果即天气信息显示到界面
        tvWeatherInfo.setText(result.get(0));
        time.setText(times.get(0));
        icon.setImageBitmap(bms.get(0));
        tvWeatherInfo01.setText(result.get(1));
        time01.setText(times.get(1));
        icon01.setImageBitmap(bms.get(1));
        tvWeatherInfo02.setText(result.get(2));
        time02.setText(times.get(2));
        icon02.setImageBitmap(bms.get(2));
        tvWeatherInfo03.setText(result.get(3));
        time03.setText(times.get(3));
        icon03.setImageBitmap(bms.get(3));
        tvWeatherInfo04.setText(result.get(4));
        time04.setText(times.get(4));
        icon04.setImageBitmap(bms.get(4));
        bms.clear();
        times.clear();
    }
}
</code></pre>

<p>}[/java]</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/android-sqlitedemo.html">Android SQLiteDemo</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-20T10:51:17+08:00" pubdate data-updated="true">Oct 20<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>该Demo简单说明了SQLite的使用方法，包括常见的增删改查操作。
Demo截图：
[fgallery id=1 w=320 h=480 t=0 title=&#8221;sqlite&#8221;]
Android Project结构：
<a href="http://l4love.org/wp-content/uploads/2011/10/project.png"><img src="http://l4love.org/wp-content/uploads/2011/10/project.png" alt="" /></a></p>

<p>数据库操作辅助类（DBHelper.java），该类封装了对SQLite数据的操作，包括了创建表，删除表，增删改查数据等方法：
[java]package com.android.SqliteDemo;</p>

<p>import android.content.ContentValues;
import android.content.Context;
import android.database.Cursor;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;
import android.database.sqlite.SQLiteDatabase.CursorFactory;
import android.util.Log;</p>

<p>public class DBHelper extends SQLiteOpenHelper {</p>

<pre><code>Context context;//应用环境上下文  
private static SQLiteDatabase db;//该辅助类维护的数据库对象
public String table_name = "files";//数据库表名
private static final String TAG = "duanhong";// 调试标签 
private String name;//数据库名
public DBHelper(Context context, String name, CursorFactory factory,
        int version) {
    super(context, name, factory, version);
    this.context = context;
    this.name = name;
    db = context.openOrCreateDatabase(name, Context.MODE_PRIVATE,null);
    drop_table();//清除数据库，便于测试
    CreateTable();//辅助类建立时运行该方法建立数据库
}
@Override
public void onCreate(SQLiteDatabase db) {

} 
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
}

public void CreateTable() {   
    try {//使用execSQL方法执行sql语句完成数据库表创建   
        db.execSQL("CREATE TABLE IF NOT EXISTS " + table_name + "(" +   
                "_id INTEGER PRIMARY KEY AUTOINCREMENT  NOT NULL,"  
                + "fileName VARCHAR, description VARCHAR"    
                + ");");   
        Log.v(TAG, "Create Table files ok");   
    } catch (Exception e) {   
        Log.v(TAG, e.toString());   
    }   
}

//初始化表，使用SQLiteDatabase提供的insert方法插入一行数据
public void initDatabase(){
    ContentValues cv = new ContentValues();//数据集，表示一行数据
    cv.put("fileName", "Test");
    cv.put("description", "初始化测试项");
    db.insert(table_name, "", cv);
}

/**
 * @param filename 欲插入条目的名称
 * @param description 欲插入条目的描述
 * @return 条目是否插入成功
 */
public boolean insert(String filename, String description){   
    String sql="";   
    try{   
        db = context.openOrCreateDatabase(name, Context.MODE_PRIVATE,null); //打开数据库供后续操作使用  
        sql="insert into files values(null,'"+ filename + "','" + description +"')";   
        db.execSQL(sql);   
        Log.v(TAG,"insert Table files ok");   
        return true;   

    }catch(Exception e){   
        Log.v(TAG,"insert Table files err ,sql: "+sql);   
        return false;   
    }   
}   
/**
 * @param fileid 欲删除的条目id
 * @return 条目是否删除成功
 */
public boolean delete(int fileid){
    String sql="";
    try{   
        db = context.openOrCreateDatabase(name, Context.MODE_PRIVATE,null);   
        sql="delete from files where _id=" + fileid;   
        db.execSQL(sql);   
        Log.v(TAG,"delete item ok");   
        return true;   

    }catch(Exception e){   
        Log.v(TAG,"delete item err ,sql: "+sql);   
        return false;   
    }
}
/**
 * @param fileid 欲修改的条目id
 * @param filename 欲修改条目名称的目标内容
 * @param description 欲修改条目的目标描述
 * @return 条目是否修改成功
 */
public boolean update(int fileid, String filename, String description){
    String sql="";   
    try{   
        db = context.openOrCreateDatabase(name, Context.MODE_PRIVATE,null);   
        sql="update files set fileName='" + filename + "',description='" + description +"' where _id=" + fileid;   
        db.execSQL(sql);   
        Log.v(TAG,"update Table files ok");   
        return true;   

    }catch(Exception e){   
        Log.v(TAG,"update Table files err ,sql: "+sql);   
        return false;   
    }
}

/**
 * @param fileid 欲查询的条目id
 * @return 欲查询条目的Cursor，使用该Cursor可得到条目各属性内容
 */
public Cursor select(int fileid){
    String sql="_id=" + fileid;
    db = context.openOrCreateDatabase(name, Context.MODE_PRIVATE,null);   
    Cursor cur=db.query(table_name, new String[]{"_id","fileName","description"}, sql, null, null, null, null);   
    return cur; 
}

public Cursor loadAll(){//返回可得到数据库所有表项的Cursor   
    db = context.openOrCreateDatabase(name, Context.MODE_PRIVATE,null);   
    Cursor cur=db.query(table_name, new String[]{"_id","fileName","description"}, null, null, null, null, null);   
    return cur;   
}   

public void drop_table(){//删除表
    String sql="";   
    try{   
        db = context.openOrCreateDatabase(name, Context.MODE_PRIVATE,null);   
        sql="drop table " + table_name;   
        db.execSQL(sql);   
        Log.v(TAG,"drop Table files ok");   
    }catch(Exception e){   
        Log.v(TAG,"drop Table files err ,sql: "+sql);     
    }
}

public void close(){  //关闭数据库 
    db.close();   
}
</code></pre>

<p>}[/java]</p>

<p>Activity代码（SQLiteDemoActivity.java）：
[java]package com.android.SqliteDemo;</p>

<p>import android.app.Activity;
import android.os.Bundle;
import android.database.Cursor;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.*;</p>

<p>public class SqliteDemoActivity extends Activity {</p>

<pre><code>public String db_name = "sqlite_test";//数据库名
Button add;
Button delete;
Button modify;
Button query;
EditText filename;
EditText description;
EditText fileid;
TextView answer;
ListView items;
DBHelper helper;
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    add = (Button)findViewById(R.id.add);//获得UI控件
    delete = (Button)findViewById(R.id.delete);
    modify = (Button)findViewById(R.id.modify);
    query = (Button)findViewById(R.id.query);
    fileid = (EditText)findViewById(R.id.fileid);
    filename = (EditText)findViewById(R.id.filename);
    description = (EditText)findViewById(R.id.description);
    answer = (TextView)findViewById(R.id.answer);
    items = (ListView)findViewById(R.id.items);
    //实例化辅助类，在辅助类中实现数据库创建并提供增删改查操作的接口
    helper = new DBHelper(this,db_name,null,2);
    helper.initDatabase();//初始化数据
    refresh();//刷新数据库内容显示
    //定义按钮点击监听器
    OnClickListener ocl = new OnClickListener(){
        public void onClick(View v) {
            int id;
            switch(v.getId()){
            case R.id.add:
                //添加条目，使用helper的insert方法，由于id是自增的，只需提供名称及描述
                helper.insert(filename.getText().toString(), description.getText().toString());
                refresh();
                break;
            case R.id.delete:
                //删除条目，从编辑框中获取欲删除的条目id
                try {//若输入id格式错误，给出提示信息
                    id = Integer.parseInt(fileid.getText().toString());
                }catch (NumberFormatException e) {
                    answer.setText("请输入纯数字的id号");
                    break;
                }
                helper.delete(id);
                refresh();
                break;
            case R.id.modify:
                //更新条目，从id编辑框中获知欲更新的条目
                try {
                    id = Integer.parseInt(fileid.getText().toString());
                }catch (NumberFormatException e) {
                    answer.setText("请输入纯数字的id号");
                    break;
                }
                helper.update(id, filename.getText().toString(), description.getText().toString());
                refresh();
                break;
            //使用id查询数据
            case R.id.query:
                try {
                    id = Integer.parseInt(fileid.getText().toString());
                }catch (NumberFormatException e) {
                    answer.setText("请输入纯数字的id号");
                    break;
                }
                Cursor cur = helper.select(id);
                cur.moveToFirst();
                filename.setText(cur.getString(1));
                description.setText(cur.getString(2));
                break;
            }
        }
    };
    //按钮绑定监听器
    add.setOnClickListener(ocl);
    delete.setOnClickListener(ocl);
    modify.setOnClickListener(ocl);
    query.setOnClickListener(ocl);
}

//刷新数据库内容显示
public void refresh(){
    Cursor cur = helper.loadAll();
    //将cursor对象交给系统管理，使cursor与Activity生命周期同步
    startManagingCursor(cur);
    ListAdapter la = new SimpleCursorAdapter(this,R.layout.list_item,cur,new String[]{"_id", "fileName", "description"},new int[]{R.id.item_fileid, R.id.item_filename, R.id.item_description});
    items.setAdapter(la);
    items.setChoiceMode(ListView.CHOICE_MODE_MULTIPLE);
    helper.close();
}
//由于仅用于测试，故在程序被销毁时删除表中数据
public void onDestroy(){
    super.onDestroy();
    helper.drop_table();
}
</code></pre>

<p>}[/java]
每一行的布局：list_item.xml
[xml]&lt;?xml version=&#8221;1.0&#8221; encoding=&#8221;utf-8&#8221;?>
&lt;LinearLayout android:id=&#8221;@+id/linearLayout1&#8221;</p>

<pre><code>android:layout_width="fill_parent" 
android:layout_height="fill_parent"
android:orientation="vertical" 
xmlns:android="http://schemas.android.com/apk/res/android"&gt;
&lt;LinearLayout android:id="@+id/linearLayout2" 
    android:layout_width="wrap_content" 
    android:layout_height="wrap_content"
    android:orientation="horizontal"&gt;
&lt;!-- &lt;CheckBox android:id="@+id/chkTodo"
    android:layout_width="40dip" 
    android:layout_height="40dip"/&gt; --&gt;
&lt;TextView android:id="@+id/item_fileid" 
    android:layout_width="fill_parent" 
    android:layout_height="wrap_content"
    android:layout_weight="1"
    android:textSize="20dip"&gt;&lt;/TextView&gt;
&lt;TextView android:id="@+id/item_filename" 
    android:layout_width="fill_parent" 
    android:layout_marginLeft="20dip"
    android:layout_marginRight="20dip"
    android:layout_height="wrap_content"
    android:layout_weight="1"
    android:textSize="20dip"&gt;&lt;/TextView&gt;
&lt;TextView android:id="@+id/item_description" 
    android:layout_width="fill_parent" 
    android:layout_height="wrap_content"
    android:layout_weight="1"
    android:textSize="20dip"&gt;&lt;/TextView&gt;
&lt;/LinearLayout&gt;
</code></pre>

<p></LinearLayout>[/xml]
布局文件：main.xml
[xml]&lt;?xml version=&#8221;1.0&#8221; encoding=&#8221;utf-8&#8221;?>
&lt;LinearLayout xmlns:android=&#8221;http://schemas.android.com/apk/res/android&#8221;</p>

<pre><code>android:orientation="vertical" android:layout_width="fill_parent"
android:layout_height="fill_parent"&gt;
&lt;TextView android:layout_width="fill_parent" android:background="#222222" android:textSize="20dip"
    android:layout_height="wrap_content" android:text="SQLite基本操作演示" /&gt;
&lt;TableLayout android:id="@+id/tableLayout1" android:layout_height="wrap_content" android:layout_width="match_parent"&gt;
    &lt;TableRow android:layout_width="fill_parent" android:layout_height="wrap_content"&gt;
        &lt;TextView android:text="ID" android:textSize="20dip" android:layout_width="fill_parent" android:layout_weight="1"/&gt;
        &lt;TextView android:text="条目名称" android:textSize="20dip" android:layout_width="fill_parent" android:layout_weight="1"/&gt;
        &lt;TextView android:text="条目描述" android:textSize="20dip" android:layout_width="fill_parent" android:layout_weight="1"/&gt;
    &lt;/TableRow&gt;
    &lt;TableRow android:layout_width="fill_parent" android:layout_height="wrap_content"&gt;
        &lt;EditText android:id="@+id/fileid" android:layout_width="fill_parent" android:layout_weight="1"/&gt;
        &lt;EditText android:id="@+id/filename" android:layout_width="fill_parent" android:layout_weight="1"/&gt;
        &lt;EditText android:id="@+id/description" android:layout_width="fill_parent" android:layout_weight="1"/&gt;
    &lt;/TableRow&gt;
&lt;/TableLayout&gt;
&lt;LinearLayout android:orientation="horizontal"
    android:layout_width="fill_parent" android:layout_height="wrap_content"&gt;
    &lt;Button android:text="增加记录" android:id="@+id/add"
        android:layout_weight="1" android:layout_width="match_parent"
        android:layout_height="wrap_content" android:textSize="20dip"
        android:layout_marginTop="5dip"&gt;&lt;/Button&gt;
    &lt;Button android:text="删除记录" android:id="@+id/delete"
        android:layout_weight="1" android:layout_width="match_parent"
        android:layout_height="wrap_content" android:textSize="20dip"
        android:layout_marginTop="5dip"&gt;&lt;/Button&gt;
&lt;/LinearLayout&gt;
&lt;LinearLayout android:orientation="horizontal"
    android:layout_width="fill_parent" android:layout_height="wrap_content"&gt;
    &lt;Button android:text="修改记录" android:id="@+id/modify"
        android:layout_weight="1" android:layout_width="wrap_content"
        android:layout_height="wrap_content" android:textSize="20dip"
        android:layout_marginTop="5dip"&gt;&lt;/Button&gt;
    &lt;Button android:text="查询记录" android:id="@+id/query"
        android:layout_weight="1" android:layout_width="wrap_content"
        android:layout_height="wrap_content" android:textSize="20dip"
        android:layout_marginTop="5dip"&gt;&lt;/Button&gt;
&lt;/LinearLayout&gt;
&lt;TextView android:layout_width="fill_parent"
    android:text="数据库内容（ID|名称|描述）" android:background="#222222"
    android:layout_height="wrap_content" android:textSize="20dip"
    android:layout_marginTop="5dip"&gt;&lt;/TextView&gt;
&lt;ListView android:id="@+id/items" android:layout_width="match_parent" 
    android:layout_height="wrap_content"&gt;&lt;/ListView&gt;
&lt;TextView android:id="@+id/answer" android:layout_width="wrap_content"
    android:layout_height="wrap_content" android:textSize="20dip"
    android:layout_marginTop="5dip"&gt;&lt;/TextView&gt;
</code></pre>

<p></LinearLayout>[/xml]</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/5/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/3/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>About Me</h1>
  <p>爱学习，不爱劳动</p>
  <p>不爱睡觉，爱睡懒觉</p>
  <p>怕热，怕冷</p>
  <p>重度强迫症患者</p>
  <p>重度拖延症患者</p>
  <p>从明天起重新做人_类患者</p>
  <p>duanhong169#gmail.com欢迎骚扰</p>
</section><section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/drupal.html">Drupal学习路线</a>
      </li>
    
      <li class="post">
        <a href="/blog/nosql-rest.html">NOSQL & REST & DSL & Event Sourcing</a>
      </li>
    
      <li class="post">
        <a href="/blog/markdown.html">Markdowns</a>
      </li>
    
      <li class="post">
        <a href="/blog/taste.html">Octopress 分割线</a>
      </li>
    
      <li class="post">
        <a href="/blog/smack-invisibility.html">Smack设置隐身状态</a>
      </li>
    
  </ul>
</section>

  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - 弘哥保护你 -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'duanhong169';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
